var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,t=Object.getOwnPropertySymbols,l=Object.prototype.propertyIsEnumerable,r=(a,t,l)=>t in a?e(a,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):a[t]=l,d=(e,d)=>{for(var s in d||(d={}))a.call(d,s)&&r(e,s,d[s]);if(t)for(var s of t(d))l.call(d,s)&&r(e,s,d[s]);return e};import{r as s,a as o,A as n,i,b as m,m as u,t as f,n as p,q as c,u as g,v as _,p as b,d as D,e as y,o as V,c as Y,f as h,F as x,x as v,h as U,y as H,z as M,g as j}from"./index.5e1381b6.js";const w={name:"ExamForm",setup(){const{proxy:e}=p();console.log("proxy",e);const a=s(null),t=c(),l=g(),{id:r}=t.query,b=o({token:n("token")||"",id:r,allClasses:[],formData:{name:"",description:"",begin:"",end:"",duration:"",indexes:[],filters:{classes:[],register_time_range:[]},status:"",is_discovered:""},rules:{name:[{required:"true"}],indexes:[{required:"true"}],status:[{required:"true"}],is_discovered:[{required:"true"}]}});i((async()=>{if(await D(),await y(),r)m.getExam(r).then((e=>{b.formData.name=e.data.name,b.formData.description=e.data.description,b.formData.begin=e.data.begin,b.formData.end=e.data.end,b.formData.duration=e.data.duration,b.formData.indexes=e.data.indexes,b.formData.filters=e.data.filters,b.formData.status=e.data.status,b.formData.is_discovered=e.data.is_discovered}));else{let e=m.listExamIndex();b.formData.indexes=e.data}})),u((()=>{}));const D=async()=>{let e=await m.listClass();b.allClasses=e.data},y=async()=>{let e=await m.listExamIndex();b.formData.indexes=e.data};return d(d({},f(b)),{formRef:a,submitAdd:()=>{a.value.validate((async e=>{if(e){let e=b.formData;e.begin&&(e.begin=dayjs(e.begin).format("YYYY-MM-DD HH:mm:ss")),e.end&&(e.end=dayjs(e.end).format("YYYY-MM-DD HH:mm:ss")),e.filters.register_time_range[0]&&(e.filters.register_time_range[0]=dayjs(e.filters.register_time_range[0]).format("YYYY-MM-DD HH:mm:ss")),e.filters.register_time_range[1]&&(e.filters.register_time_range[1]=dayjs(e.filters.register_time_range[1]).format("YYYY-MM-DD HH:mm:ss")),console.log(e),r?await m.updateExam(r,e):await m.storeExam(e),await l.push({name:"exam"})}}))},handleBeforeUpload:e=>{const a=e.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(a))return _.error("请上传 jpg、jpeg、png 格式的图片"),!1},handleUrlSuccess:e=>{b.formData.goodsCoverImg=e.data||""},handleChangeCate:e=>{b.categoryId=e[2]||0}})}},k=j();b("data-v-dbbd5ff8");const E=U("Enabled"),C=U("Disabled"),q=U("No"),I=U("Yes"),O=h("div",{style:{color:"#aaa"}},"Unit: days. When assign to user, begin and end are used if they are specified. Otherwise begin time is the time at assignment, and the end time is the time at assignment plus the duration.",-1),S=U("Submit");D();const T=k(((e,a,t,l,r,d)=>{const s=y("el-input"),o=y("el-form-item"),n=y("el-checkbox"),i=y("el-col"),m=y("el-row"),u=y("el-radio"),f=y("el-radio-group"),p=y("el-date-picker"),c=y("el-checkbox-group"),g=y("el-button"),_=y("el-form");return V(),Y("div",null,[h(m,null,{default:k((()=>[h(i,{span:12},{default:k((()=>[h(_,{model:e.formData,rules:e.rules,ref:"formRef","label-width":"200px",class:"formData"},{default:k((()=>[h(o,{label:"Name",prop:"name"},{default:k((()=>[h(s,{modelValue:e.formData.name,"onUpdate:modelValue":a[1]||(a[1]=a=>e.formData.name=a),placeholder:""},null,8,["modelValue"])])),_:1}),h(o,{label:"Index",prop:"indexes"},{default:k((()=>[(V(!0),Y(x,null,v(e.formData.indexes,((e,a)=>(V(),Y(m,{key:a},{default:k((()=>[h(i,{span:6},{default:k((()=>[h(n,{modelValue:e.checked,"onUpdate:modelValue":a=>e.checked=a,label:e.checked},{default:k((()=>[U(H(e.name),1)])),_:2},1032,["modelValue","onUpdate:modelValue","label"])])),_:2},1024),h(i,{span:12},{default:k((()=>[h(s,{type:"number",modelValue:e.require_value,"onUpdate:modelValue":a=>e.require_value=a},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),h(i,{span:6,style:{padding:"0 20px",color:"#aaa"}},{default:k((()=>[e.unit?(V(),Y(x,{key:0},[U(" Unit: "+H(e.unit),1)],64)):M("",!0)])),_:2},1024)])),_:2},1024)))),128))])),_:1}),h(o,{label:"Status",prop:"status"},{default:k((()=>[h(f,{modelValue:e.formData.status,"onUpdate:modelValue":a[2]||(a[2]=a=>e.formData.status=a)},{default:k((()=>[h(u,{label:0},{default:k((()=>[E])),_:1}),h(u,{label:1},{default:k((()=>[C])),_:1})])),_:1},8,["modelValue"])])),_:1}),h(o,{label:"Discovered",prop:"is_discovered"},{default:k((()=>[h(f,{modelValue:e.formData.is_discovered,"onUpdate:modelValue":a[3]||(a[3]=a=>e.formData.is_discovered=a)},{default:k((()=>[h(u,{label:0},{default:k((()=>[q])),_:1}),h(u,{label:1},{default:k((()=>[I])),_:1})])),_:1},8,["modelValue"])])),_:1}),h(o,{label:"Begin",prop:"begin"},{default:k((()=>[h(p,{modelValue:e.formData.begin,"onUpdate:modelValue":a[4]||(a[4]=a=>e.formData.begin=a),type:"datetime",format:"YYYY-MM-DD HH:mm:ss",placeholder:"Select Begin Time"},null,8,["modelValue"])])),_:1}),h(o,{label:"End",prop:"end"},{default:k((()=>[h(p,{modelValue:e.formData.end,"onUpdate:modelValue":a[5]||(a[5]=a=>e.formData.end=a),type:"datetime",format:"YYYY-MM-DD HH:mm:ss",placeholder:"Select End Time"},null,8,["modelValue"])])),_:1}),h(o,{label:"Duration",prop:"duration"},{default:k((()=>[h(s,{modelValue:e.formData.duration,"onUpdate:modelValue":a[6]||(a[6]=a=>e.formData.duration=a),type:"number",placeholder:""},null,8,["modelValue"]),O])),_:1}),h(o,{label:"Target User Class",prop:"filters.classes"},{default:k((()=>[h(c,{modelValue:e.formData.filters.classes,"onUpdate:modelValue":a[7]||(a[7]=a=>e.formData.filters.classes=a)},{default:k((()=>[(V(!0),Y(x,null,v(e.allClasses,((e,a)=>(V(),Y(n,{label:a,key:a},{default:k((()=>[U(H(e),1)])),_:2},1032,["label"])))),128))])),_:1},8,["modelValue"])])),_:1}),h(o,{label:"Target User Register Time"},{default:k((()=>[h(p,{modelValue:e.formData.filters.register_time_range,"onUpdate:modelValue":a[8]||(a[8]=a=>e.formData.filters.register_time_range=a),type:"datetimerange",format:"YYYY-MM-DD HH:mm:ss","range-separator":"to","start-placeholder":"Begin","end-placeholder":"End"},null,8,["modelValue"])])),_:1}),h(o,{label:"Description",prop:"description"},{default:k((()=>[h(s,{type:"textarea",modelValue:e.formData.description,"onUpdate:modelValue":a[9]||(a[9]=a=>e.formData.description=a),placeholder:""},null,8,["modelValue"])])),_:1}),h(o,null,{default:k((()=>[h(g,{type:"primary",onClick:a[10]||(a[10]=e=>l.submitAdd())},{default:k((()=>[S])),_:1})])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})])}));w.render=T,w.__scopeId="data-v-dbbd5ff8";export default w;
