var e=Object.defineProperty,a=Object.prototype.hasOwnProperty,l=Object.getOwnPropertySymbols,t=Object.prototype.propertyIsEnumerable,n=(a,l,t)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[l]=t,s=(e,s)=>{for(var d in s||(s={}))a.call(s,d)&&n(e,d,s[d]);if(l)for(var d of l(s))t.call(s,d)&&n(e,d,s[d]);return e};import{r as d,a as o,t as r,b as i,v as u,e as m,j as f,o as c,c as p,s as b,f as g,k as x,F as _,x as h,h as y,i as v,q as I,u as E,p as w,d as D,y as A,z as k,g as C}from"./index.78e4ea26.js";const U={name:"DialogAssignExam",props:{reload:Function},setup(e,a){const l=d(null),t=o({loading:!1,matchExams:[],visible:!1,formData:{uid:0,exam_id:"",time_range:[]},rules:{exam_id:[{required:"true"}]}});return s(s({},r(t)),{handleSubmit:()=>{l.value.validate((async a=>{if(a){let a=await i.storeExamUser(t.formData);t.visible=!1,u.success(a.msg),e.reload&&e.reload()}}))},formRef:l,open:e=>{t.formData.uid=e,0==t.matchExams.length&&(t.loading=!0,(async()=>{let e=await i.listUserMatchExams({uid:t.formData.uid});t.matchExams=e.data})(),t.loading=!1),t.visible=!0}})}},V=g("div",{class:"time-range-help-text"},"If the time range is not specified, the exam's own configured time range will be used.",-1),z={class:"dialog-footer"},R=y("Cancel"),P=y("Save");U.render=function(e,a,l,t,n,s){const d=m("el-option"),o=m("el-select"),r=m("el-form-item"),i=m("el-date-picker"),u=m("el-form"),y=m("el-button"),v=m("el-dialog"),I=f("loading");return c(),p(v,{title:"Assign exam to user",modelValue:e.visible,"onUpdate:modelValue":a[4]||(a[4]=a=>e.visible=a),center:"","close-on-click-modal":!1},{footer:b((()=>[g("span",z,[g(y,{onClick:a[3]||(a[3]=a=>e.visible=!1)},{default:b((()=>[R])),_:1}),g(y,{type:"primary",onClick:t.handleSubmit},{default:b((()=>[P])),_:1},8,["onClick"])])])),default:b((()=>[x(g(u,{model:e.formData,"label-width":"100px",ref:"formRef",rules:e.rules},{default:b((()=>[g(r,{label:"Exam",prop:"exam_id"},{default:b((()=>[g(o,{modelValue:e.formData.exam_id,"onUpdate:modelValue":a[1]||(a[1]=a=>e.formData.exam_id=a),placeholder:"Select an exam..."},{default:b((()=>[(c(!0),p(_,null,h(e.matchExams,(e=>(c(),p(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),g(r,{label:"Time range",prop:"time_range"},{default:b((()=>[g(i,{modelValue:e.formData.time_range,"onUpdate:modelValue":a[2]||(a[2]=a=>e.formData.time_range=a),type:"datetimerange",format:"YYYY-MM-DD HH:mm:ss","range-separator":"to","start-placeholder":"Begin","end-placeholder":"End"},null,8,["modelValue"]),V])),_:1})])),_:1},8,["model","rules"]),[[I,e.loading]])])),_:1},8,["modelValue"])};const O={name:"UserDetail",components:{DialogAssignExam:U},setup(){const e=I();E();const{id:a}=e.query,l=d(null),t=o({loading:!1,baseInfo:{},examInfo:null});v((()=>{n()}));const n=async()=>{t.loading=!0;let e=await i.getUser(a);t.loading=!1,t.baseInfo=e.data.base_info,t.examInfo=e.data.exam_info};return s(s({},r(t)),{handleRemoveExam:async e=>{let a=await i.deleteExamUser(e);u.success(a.msg),await n()},handleAssignExam:async()=>{l.value.open(a)},assignExam:l,fetchPageData:n})}},j=C();w("data-v-464d881b");const S={class:"page-user-detail"},q=g("div",{class:"card-header"},[g("span",null,"Base info")],-1),M={class:"table-base-info"},Y=g("tr",null,[g("th",null,"Field"),g("th",null,"Value"),g("th",null,"Actions"),g("th",null,"Other")],-1),B=g("td",null,"Username",-1),F=g("td",null,null,-1),H={colspan:"7"},N={class:"other-actions"},T=y("Reset password"),G=y("PM"),J=y("Assign exam"),K=g("td",null,"Email",-1),L=y("Change"),Q=g("td",null,"Added",-1),W=g("td",null,"Class",-1),X=g("td",null,"Uploaded",-1),Z=y("Add"),$=g("td",null,"Downloaded",-1),ee=y("Add"),ae=g("td",null,"Bonus",-1),le=y("Add"),te=g("div",{class:"card-header"},[g("span",null,"Exam on the way")],-1),ne={class:"table-base-info"},se=g("td",null,"Name",-1),de=g("td",null,"Created at",-1),oe=g("td",null,"Exam time",-1),re=g("td",null,"Status",-1),ie=g("td",null,"Action",-1),ue=y("Remove"),me=y("Pass !"),fe=y("Not Pass !");D();const ce=j(((e,a,l,t,n,s)=>{const d=m("el-button"),o=m("el-card"),r=m("el-popconfirm"),i=m("el-col"),u=m("el-table-column"),b=m("el-tag"),h=m("el-table"),y=m("el-row"),v=m("DialogAssignExam"),I=f("loading");return c(),p(_,null,[x(g("div",S,[g(o,null,{header:j((()=>[q])),default:j((()=>[g("table",M,[Y,g("tr",null,[B,g("td",null,A(e.baseInfo.username),1),F,g("td",H,[g("div",N,[g(d,{type:"primary",size:"mini"},{default:j((()=>[T])),_:1}),g(d,{type:"primary",size:"mini"},{default:j((()=>[G])),_:1}),g(d,{type:"primary",size:"mini",onClick:t.handleAssignExam},{default:j((()=>[J])),_:1},8,["onClick"])])])]),g("tr",null,[K,g("td",null,A(e.baseInfo.email),1),g("td",null,[g(d,{size:"mini"},{default:j((()=>[L])),_:1})])]),g("tr",null,[Q,g("td",null,A(e.baseInfo.added),1)]),g("tr",null,[W,g("td",null,A(e.baseInfo.class_text),1)]),g("tr",null,[X,g("td",null,A(e.baseInfo.uploaded_text),1),g("td",null,[g(d,{size:"mini"},{default:j((()=>[Z])),_:1})])]),g("tr",null,[$,g("td",null,A(e.baseInfo.downloaded_text),1),g("td",null,[g(d,{size:"mini"},{default:j((()=>[ee])),_:1})])]),g("tr",null,[ae,g("td",null,A(e.baseInfo.bonus),1),g("td",null,[g(d,{size:"mini"},{default:j((()=>[le])),_:1})])])])])),_:1}),e.examInfo?(c(),p(o,{key:0},{header:j((()=>[te])),default:j((()=>[g(y,null,{default:j((()=>[g(i,{span:12},{default:j((()=>[g("table",ne,[g("tr",null,[se,g("td",null,A(e.examInfo.exam&&e.examInfo.exam.name),1)]),g("tr",null,[de,g("td",null,A(e.examInfo.created_at),1)]),g("tr",null,[oe,g("td",null,A(e.examInfo.begin)+" ~ "+A(e.examInfo.end),1)]),g("tr",null,[re,g("td",null,A(e.examInfo.status_text),1)]),g("tr",null,[ie,g("td",null,[g(r,{title:"Confirm Remove ?",onConfirm:a[1]||(a[1]=a=>t.handleRemoveExam(e.examInfo.id))},{reference:j((()=>[g(d,{type:"danger",size:"small"},{default:j((()=>[ue])),_:1})])),_:1})])])])])),_:1}),g(i,{span:12},{default:j((()=>[g(h,{data:e.examInfo.progress_formatted},{default:j((()=>[g(u,{prop:"name",label:"Index"}),g(u,{prop:"require_value_formatted",label:"Require"}),g(u,{prop:"current_value_formatted",label:"Current"}),g(u,{prop:"result",label:"Result"},{default:j((e=>[e.row.passed?(c(),p(b,{key:0,type:"success"},{default:j((()=>[me])),_:1})):k("",!0),e.row.passed?k("",!0):(c(),p(b,{key:1,type:"danger"},{default:j((()=>[fe])),_:1}))])),_:1})])),_:1},8,["data"])])),_:1})])),_:1})])),_:1})):k("",!0)],512),[[I,e.loading]]),g(v,{ref:"assignExam",reload:t.fetchPageData},null,8,["reload"])],64)}));O.render=ce,O.__scopeId="data-v-464d881b";export default O;
