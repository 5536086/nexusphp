var N=Object.defineProperty,S=Object.defineProperties;var T=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var C=(t,e,i)=>e in t?N(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,E=(t,e)=>{for(var i in e||(e={}))A.call(e,i)&&C(t,i,e[i]);if(w)for(var i of w(e))R.call(e,i)&&C(t,i,e[i]);return t},B=(t,e)=>S(t,T(e));import{G as $,B as F,d as G,u as L,r as O,o as W,H as z,t as J,e as m,f as D,g as y,k as a,w as l,I as v,E as K,F as h,A as j,l as u,h as P,q,j as M,i as Q}from"./vendor.7b1bb722.js";import{_ as X,b as Z,a as b}from"./index.e2c54dc2.js";const ee={name:"ExamForm",setup(){const{proxy:t}=$();console.log("proxy",t);const e=F(null),i=G(),k=L(),{id:f}=i.query,n=O({token:Z("token")||"",id:f,allClasses:[],formData:{name:"",description:"",begin:"",end:"",duration:"",indexes:[],filters:{classes:[],register_time_range:[],donate_status:[]},status:"",is_discovered:""},rules:{name:[{required:"true"}],indexes:[{required:"true"}],status:[{required:"true"}],is_discovered:[{required:"true"}]}});W(async()=>{await V(),await c(),f&&b.getExam(f).then(s=>{n.formData.name=s.data.name,n.formData.description=s.data.description,n.formData.begin=s.data.begin,n.formData.end=s.data.end,n.formData.duration=s.data.duration,n.formData.indexes=s.data.indexes,n.formData.filters=s.data.filters,n.formData.status=s.data.status,n.formData.is_discovered=s.data.is_discovered})}),z(()=>{});const p=()=>{e.value.validate(async s=>{if(s){let r=n.formData;console.log(r),r.begin&&(r.begin=v(r.begin).format("YYYY-MM-DD HH:mm:ss")),r.end&&(r.end=v(r.end).format("YYYY-MM-DD HH:mm:ss")),r.filters.register_time_range&&r.filters.register_time_range[0]&&(r.filters.register_time_range[0]=v(r.filters.register_time_range[0]).format("YYYY-MM-DD HH:mm:ss")),r.filters.register_time_range&&r.filters.register_time_range[1]&&(r.filters.register_time_range[1]=v(r.filters.register_time_range[1]).format("YYYY-MM-DD HH:mm:ss")),console.log(r),f?await b.updateExam(f,r):await b.storeExam(r),await k.push({name:"exam"})}})},d=s=>{const r=s.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(r))return K.error("\u8BF7\u4E0A\u4F20 jpg\u3001jpeg\u3001png \u683C\u5F0F\u7684\u56FE\u7247"),!1},_=s=>{n.formData.goodsCoverImg=s.data||""},g=s=>{n.categoryId=s[2]||0},V=async()=>{let s=await b.listClass();n.allClasses=s.data},c=async()=>{let s=await b.listExamIndex();n.formData.indexes=s.data};return B(E({},J(n)),{formRef:e,submitAdd:p,handleBeforeUpload:d,handleUrlSuccess:_,handleChangeCate:g})}},ae=u("Enabled"),te=u("Disabled"),le=u("No"),oe=u("Yes"),se=P("div",{style:{color:"#aaa"}},"Unit: days. When assign to user, begin and end are used if they are specified. Otherwise begin time is the time at assignment, and the end time is the time at assignment plus the duration.",-1),re=u("No"),ne=u("Yes"),de=u("Submit");function ie(t,e,i,k,f,n){const p=m("el-input"),d=m("el-form-item"),_=m("el-checkbox"),g=m("el-col"),V=m("el-row"),c=m("el-radio"),s=m("el-radio-group"),r=m("el-date-picker"),H=m("el-checkbox-group"),x=m("el-button"),I=m("el-form");return D(),y("div",null,[a(V,null,{default:l(()=>[a(g,{span:12},{default:l(()=>[a(I,{model:t.formData,rules:t.rules,ref:"formRef","label-width":"200px",class:"formData"},{default:l(()=>[a(d,{label:"Name",prop:"name"},{default:l(()=>[a(p,{modelValue:t.formData.name,"onUpdate:modelValue":e[0]||(e[0]=o=>t.formData.name=o),placeholder:""},null,8,["modelValue"])]),_:1}),a(d,{label:"Index",prop:"indexes"},{default:l(()=>[(D(!0),y(h,null,j(t.formData.indexes,(o,Y)=>(D(),q(V,{key:Y,style:{width:"100%"}},{default:l(()=>[a(g,{span:6},{default:l(()=>[a(_,{modelValue:o.checked,"onUpdate:modelValue":U=>o.checked=U,label:o.checked},{default:l(()=>[u(M(o.name),1)]),_:2},1032,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),a(g,{span:12},{default:l(()=>[a(p,{type:"number",modelValue:o.require_value,"onUpdate:modelValue":U=>o.require_value=U},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),a(g,{span:6,style:{padding:"0 20px",color:"#aaa"}},{default:l(()=>[o.unit?(D(),y(h,{key:0},[u(" Unit: "+M(o.unit),1)],64)):Q("",!0)]),_:2},1024)]),_:2},1024))),128))]),_:1}),a(d,{label:"Status",prop:"status"},{default:l(()=>[a(s,{modelValue:t.formData.status,"onUpdate:modelValue":e[1]||(e[1]=o=>t.formData.status=o)},{default:l(()=>[a(c,{label:0},{default:l(()=>[ae]),_:1}),a(c,{label:1},{default:l(()=>[te]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"Discovered",prop:"is_discovered"},{default:l(()=>[a(s,{modelValue:t.formData.is_discovered,"onUpdate:modelValue":e[2]||(e[2]=o=>t.formData.is_discovered=o)},{default:l(()=>[a(c,{label:0},{default:l(()=>[le]),_:1}),a(c,{label:1},{default:l(()=>[oe]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"Begin",prop:"begin"},{default:l(()=>[a(r,{modelValue:t.formData.begin,"onUpdate:modelValue":e[3]||(e[3]=o=>t.formData.begin=o),type:"datetime",format:"YYYY-MM-DD HH:mm:ss",placeholder:"Select Begin Time"},null,8,["modelValue"])]),_:1}),a(d,{label:"End",prop:"end"},{default:l(()=>[a(r,{modelValue:t.formData.end,"onUpdate:modelValue":e[4]||(e[4]=o=>t.formData.end=o),type:"datetime",format:"YYYY-MM-DD HH:mm:ss",placeholder:"Select End Time"},null,8,["modelValue"])]),_:1}),a(d,{label:"Duration",prop:"duration"},{default:l(()=>[a(p,{modelValue:t.formData.duration,"onUpdate:modelValue":e[5]||(e[5]=o=>t.formData.duration=o),type:"number",placeholder:""},null,8,["modelValue"]),se]),_:1}),a(d,{label:"Target user class",prop:"filters.classes"},{default:l(()=>[a(H,{modelValue:t.formData.filters.classes,"onUpdate:modelValue":e[6]||(e[6]=o=>t.formData.filters.classes=o)},{default:l(()=>[(D(!0),y(h,null,j(t.allClasses,(o,Y)=>(D(),q(_,{label:Y,key:Y},{default:l(()=>[u(M(o),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"Target user donated",prop:"filters.donate_status"},{default:l(()=>[a(H,{modelValue:t.formData.filters.donate_status,"onUpdate:modelValue":e[7]||(e[7]=o=>t.formData.filters.donate_status=o)},{default:l(()=>[a(_,{label:"no"},{default:l(()=>[re]),_:1}),a(_,{label:"yes"},{default:l(()=>[ne]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(d,{label:"Target user register time"},{default:l(()=>[a(r,{modelValue:t.formData.filters.register_time_range,"onUpdate:modelValue":e[8]||(e[8]=o=>t.formData.filters.register_time_range=o),type:"datetimerange",format:"YYYY-MM-DD HH:mm:ss","range-separator":"to","start-placeholder":"Begin","end-placeholder":"End"},null,8,["modelValue"])]),_:1}),a(d,{label:"Description",prop:"description"},{default:l(()=>[a(p,{type:"textarea",modelValue:t.formData.description,"onUpdate:modelValue":e[9]||(e[9]=o=>t.formData.description=o),placeholder:""},null,8,["modelValue"])]),_:1}),a(d,null,{default:l(()=>[a(x,{type:"primary",onClick:e[10]||(e[10]=o=>k.submitAdd())},{default:l(()=>[de]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})])}var pe=X(ee,[["render",ie]]);export{pe as default};
